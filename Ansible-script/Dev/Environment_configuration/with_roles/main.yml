---

- name: CI tools installation/configuration
  hosts: "{{ host_name }}"
  become: true
  vars_files: 
   - vars/all.yaml 
  tasks:
      - name: Install dependencies
        apt: 
          name: '{{ item }}'
          state: present
        with_items:
          - apt-transport-https
          - ca-certificates
          - software-properties-common

      - name: Download MS product repository
        get_url:
          url: https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb
          dest: /tmp/packages-microsoft-prod.deb

      - name: Install MS product repository
        apt: deb=/tmp/packages-microsoft-prod.deb 
        become: true

      - name: Install .NET SDK
        apt:
         name: dotnet-sdk-7.0
         state: present
         update_cache: true

    # - name: install nginx dependencies 
    #   ansible.builtin.import_role:
    #    name: nginx
 
      # - name: create a user
      #   ansible.builtin.import_role:
      #     name: create-user

    # - name: Install Python
    #   ansible.builtin.import_role:
    #     name: python-3
       
      - name: install docker 
        ansible.builtin.import_role:
          name: docker_with_experimental_mode

    # - name: install sonarqube 
    #   ansible.builtin.import_role:
    #    name: sonarqube

    # - name: install sonarscanner 
    #   ansible.builtin.import_role:
    #    name: sonar-scanner       

    # - name: install nvm and node 
    #   ansible.builtin.import_role:
    #     name: nvm_and_node









